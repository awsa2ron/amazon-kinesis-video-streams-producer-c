cmake_minimum_required(VERSION 2.8)

project(libmbedtls-download NONE)

find_program(MAKE_EXE NAMES make)

include(ExternalProject)

ExternalProject_Add(project_libmbedtls
            GIT_REPOSITORY    https://github.com/ARMmbed/mbedtls.git
            GIT_TAG           mbedtls-2.16.5
            PREFIX            ${CMAKE_CURRENT_BINARY_DIR}/build
            CMAKE_ARGS
                -DCMAKE_INSTALL_PREFIX=${CMAKE_SOURCE_DIR}/../local/
                -DUSE_SHARED_MBEDTLS_LIBRARY=1
                -DCMAKE_BUILD_TYPE=Release
            BUILD_ALWAYS      TRUE
            TEST_COMMAND      "")